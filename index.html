<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/L.Control.Locate.min.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <link rel="stylesheet" href="css/leaflet-measure.css">
        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title>ETA INDEX</title>
    </head>
    <body>
        <div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/L.Control.Layers.Tree.min.js"></script>
        <script src="js/L.Control.Locate.min.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-measure.js"></script>
        <script src="data/KATWA_1.js"></script>
        <script>
        var highlightLayer;
        function highlightFeature(e) {
            highlightLayer = e.target;
            highlightLayer.openPopup();
        }
        var map = L.map('map', {
            zoomControl:false, maxZoom:28, minZoom:1
        }).fitBounds([[23.603966986439936,88.07771615726331],[23.670040559473712,88.21811679621167]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        // remove popup's row if "visible-with-data"
        function removeEmptyRowsFromPopupContent(content, feature) {
         var tempDiv = document.createElement('div');
         tempDiv.innerHTML = content;
         var rows = tempDiv.querySelectorAll('tr');
         for (var i = 0; i < rows.length; i++) {
             var td = rows[i].querySelector('td.visible-with-data');
             var key = td ? td.id : '';
             if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                 rows[i].parentNode.removeChild(rows[i]);
             }
         }
         return tempDiv.innerHTML;
        }
        // add class to format popup if it contains media
		function addClassToPopupIfMedia(content, popup) {
			var tempDiv = document.createElement('div');
			tempDiv.innerHTML = content;
			if (tempDiv.querySelector('td img')) {
				popup._contentNode.classList.add('media');
					// Delay to force the redraw
					setTimeout(function() {
						popup.update();
					}, 10);
			} else {
				popup._contentNode.classList.remove('media');
			}
		}
        var title = new L.Control({'position':'topright'});
        title.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info');
            this.update();
            return this._div;
        };
        title.update = function () {
            this._div.innerHTML = '<h2>ETA INDEX</h2>';
        };
        title.addTo(map);
        var abstract = new L.Control({'position':'bottomleft'});
        abstract.onAdd = function (map) {
            this._div = L.DomUtil.create('div',
            'leaflet-control abstract');
            this._div.id = 'abstract'
                this._div.setAttribute("onmouseenter", "abstract.show()");
                this._div.setAttribute("onmouseleave", "abstract.hide()");
                this.hide();
                return this._div;
            };
            abstract.hide = function () {
                this._div.classList.remove("abstractUncollapsed");
                this._div.classList.add("abstract");
                this._div.innerHTML = 'i'
            }
            abstract.show = function () {
                this._div.classList.remove("abstract");
                this._div.classList.add("abstractUncollapsed");
                this._div.innerHTML = 'The Eta Index is a structural metric used to evaluate the complexity and connectivity of a road network by calculating the average length of links (roads) per node (junction), which reflects how extensively the network branches out. In this context, the Eta Index was applied to assess the structural characteristics of the road network, with each value represented spatially across the study area. Areas with low Eta values, shown in orange, indicate a less connected and simpler road network structure, often characterized by shorter road segments and fewer linkages per junction, which may imply limited accessibility, sparse development, or early stages of infrastructural growth. On the other hand, areas with high Eta values, depicted in violet, represent a more complex and well-integrated road system where junctions are connected by longer and potentially more numerous road segments, indicating higher network development, better spatial connectivity, and possibly urbanized zones with a denser road framework. This gradient from orange to violet visually highlights the variation in road network structure, offering important insights for urban planning, infrastructure development, and the identification of areas that may require enhanced connectivity to support balanced regional development.';
        };
        abstract.addTo(map);
        var zoomControl = L.control.zoom({
            position: 'topleft'
        }).addTo(map);
        L.control.locate({locateOptions: {maxZoom: 19}}).addTo(map);
        var measureControl = new L.Control.Measure({
            position: 'topleft',
            primaryLengthUnit: 'meters',
            secondaryLengthUnit: 'kilometers',
            primaryAreaUnit: 'sqmeters',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].innerHTML = '';
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].className += ' fas fa-ruler';
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        map.createPane('pane_GoogleRoad_0');
        map.getPane('pane_GoogleRoad_0').style.zIndex = 400;
        var layer_GoogleRoad_0 = L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            pane: 'pane_GoogleRoad_0',
            opacity: 1.0,
            attribution: '<a href="https://www.google.at/permissions/geoguidelines/attr-guide.html">Map data Â©2015 Google</a>',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 20
        });
        layer_GoogleRoad_0;
        map.addLayer(layer_GoogleRoad_0);
        function pop_KATWA_1(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Word No.:</th>\
                        <td class="visible-with-data" id="WARD_NO">' + (feature.properties['WARD_NO'] !== null ? autolinker.link(String(feature.properties['WARD_NO']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Eta Value:</th>\
                        <td class="visible-with-data" id="Eta">' + (feature.properties['Eta'] !== null ? autolinker.link(String(feature.properties['Eta']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_KATWA_1_0(feature) {
            if (feature.properties['Eta'] >= 0.631000 && feature.properties['Eta'] <= 1.222800 ) {
                return {
                pane: 'pane_KATWA_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(230,97,1,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['Eta'] >= 1.222800 && feature.properties['Eta'] <= 1.809800 ) {
                return {
                pane: 'pane_KATWA_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(253,184,99,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['Eta'] >= 1.809800 && feature.properties['Eta'] <= 2.289000 ) {
                return {
                pane: 'pane_KATWA_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(247,247,247,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['Eta'] >= 2.289000 && feature.properties['Eta'] <= 3.400000 ) {
                return {
                pane: 'pane_KATWA_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(178,171,210,1.0)',
                interactive: true,
            }
            }
            if (feature.properties['Eta'] >= 3.400000 && feature.properties['Eta'] <= 11.173000 ) {
                return {
                pane: 'pane_KATWA_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(94,60,153,1.0)',
                interactive: true,
            }
            }
        }
        map.createPane('pane_KATWA_1');
        map.getPane('pane_KATWA_1').style.zIndex = 401;
        map.getPane('pane_KATWA_1').style['mix-blend-mode'] = 'normal';
        var layer_KATWA_1 = new L.geoJson(json_KATWA_1, {
            attribution: '',
            interactive: true,
            dataVar: 'json_KATWA_1',
            layerName: 'layer_KATWA_1',
            pane: 'pane_KATWA_1',
            onEachFeature: pop_KATWA_1,
            style: style_KATWA_1_0,
        });
        bounds_group.addLayer(layer_KATWA_1);
        map.addLayer(layer_KATWA_1);
        var overlaysTree = [
            {label: 'KATWA<br /><table><tr><td style="text-align: center;"><img src="legend/KATWA_1_0631220.png" /></td><td>0.63 - 1.22</td></tr><tr><td style="text-align: center;"><img src="legend/KATWA_1_1221811.png" /></td><td>1.22 - 1.81</td></tr><tr><td style="text-align: center;"><img src="legend/KATWA_1_1812292.png" /></td><td>1.81 - 2.29</td></tr><tr><td style="text-align: center;"><img src="legend/KATWA_1_229343.png" /></td><td>2.29 - 3.4</td></tr><tr><td style="text-align: center;"><img src="legend/KATWA_1_3411174.png" /></td><td>3.4 - 11.17</td></tr></table>', layer: layer_KATWA_1},
            {label: "Google Road", layer: layer_GoogleRoad_0},]
        var lay = L.control.layers.tree(null, overlaysTree,{
            //namedToggle: true,
            //selectorBack: false,
            //closedSymbol: '&#8862; &#x1f5c0;',
            //openedSymbol: '&#8863; &#x1f5c1;',
            //collapseAll: 'Collapse all',
            //expandAll: 'Expand all',
            collapsed: true,
        });
        lay.addTo(map);
        setBounds();
        </script>
    </body>
</html>
